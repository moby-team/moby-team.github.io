(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[123],{612:function(e,t,o){Promise.resolve().then(o.bind(o,4054))},4205:function(e,t,o){"use strict";o.d(t,{Z:function(){return a}});var n=o(9268),r=o(2914),s=o.n(r),i=o(2319),l=o.n(i);function a(){return(0,n.jsx)("div",{style:{marginTop:"5%"},children:(0,n.jsxs)("p",{className:s().className,style:{fontSize:"24pt",color:"white"},children:["Welcome, ",(0,n.jsx)("b",{className:l().className,style:{fontSize:"24pt",color:"white"},children:" User "})," \uD83D\uDC4B"]})})}},4054:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return F}});var n=o(9268),r=o(6006),s=o(1024),i=o(2040),l=o(9362),a=o(6008),c=o(2914),d=o.n(c),h=o(2319),u=o.n(h),p=o(1083).Buffer;function x(e){let{setTheScript:t,setScriptTitle:o,isParseLoading:c,setParseLoad:h,isParseError:x,setParseError:g,isGPTLoading:f,setGPTLoad:m,isGPTError:j,setGPTError:y,isTTSLoading:w,setTTSLoad:k,isTTSError:b,setTTSError:v}=e,[C,S]=(0,r.useState)(null),[N,E]=(0,r.useState)(""),[T,L]=(0,r.useState)([]),[Z,B]=(0,r.useState)(!1),[I,z]=(0,r.useState)(0),[D,F]=(0,r.useState)("2px dotted #B8E2F0"),M=(0,r.useRef)(null),R=(0,a.useRouter)(),O=async()=>{var e,t,n,r,s,i,l,a,c,d,h;console.log(null===(t=M.current)||void 0===t?void 0:null===(e=t.files[0])||void 0===e?void 0:e.name),o(null===(r=M.current)||void 0===r?void 0:null===(n=r.files[0])||void 0===n?void 0:n.name),(null===(s=M.current)||void 0===s?void 0:s.files)&&await E(null===(l=M.current)||void 0===l?void 0:null===(i=l.files[0])||void 0===i?void 0:i.name),await S(null===(a=M.current)||void 0===a?void 0:a.files[0]),z(25);let u=null===(c=M.current)||void 0===c?void 0:c.files[0],p=new FormData;p.append("file",u);let x=null===(h=M.current)||void 0===h?void 0:null===(d=h.files[0])||void 0===d?void 0:d.name;P(x)},P=async e=>{let t=new FormData;t.append("fileName",e);let o=t.get("fileName");console.log("targetFile",o),o.includes("White-Room")&&console.log("white"),o.includes("Risk-Management")&&console.log("risk"),B(!0),F("none"),h(!0);try{let e=await fetch("/api/docAI_parse",{method:"POST",body:JSON.stringify(o),headers:{"Content-Type":"application/json"}}),t=await e.json(),n=t.scriptObjects;z(50),console.log("returned from workbench",n),_(n)}catch(e){g(!0),console.log("error",e),console.error("something went wrong, check your console."),R.push("/script/error")}},W=async e=>{let t=new Blob([e]).size;if(z(100),m(!1),k(!0),t<4e3)try{let t=await fetch("/api/gc_TTS",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"audio/mp3"}}),o=await t.json(),n=p.from(o.buffer);return k(!1),n}catch(e){console.log("TTS error",e),console.error("something went wrong with text to speech, check your console"),R.push("/script/error")}else v(!0),console.error("The file is too big")},_=async e=>{m(!0),h(!1),z(75);try{console.log("returned from chat",e),e&&e.forEach(async e=>{if("SCENE_ACTION"!==e.type){let t=e.line&&e.line.replace(/ *\([^)]*\) */g,""),o=await W(t);e.audioBuffer=o}}),await L(e),await t(e)}catch(e){y(!0),console.log("GPT error",e),console.error("something went wrong with chat gpt, check your console"),R.push("/script/error")}};return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(s.Z,{className:"text-center .shadow-5",style:{width:"446px",height:"231px",border:"".concat(D),backgroundColor:"#3E3E43",marginTop:"32px"},children:[(0,n.jsx)(s.Z.Header,{className:"d-flex justify-content-end",style:{background:"none",border:"none",padding:"0 10px 0 0"},children:(0,n.jsx)(l.Z,{variant:"none",className:"",href:"/",children:(0,n.jsxs)("svg",{width:"21",height:"20",viewBox:"0 0 21 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsxs)("g",{clipPath:"url(#clip0_705_1930)",children:[(0,n.jsx)("path",{d:"M20 4L4 20",stroke:"white",strokeWidth:"1.5"}),(0,n.jsx)("path",{d:"M4 4L20 20",stroke:"white",strokeWidth:"1.5"})]}),(0,n.jsx)("defs",{children:(0,n.jsx)("clipPath",{id:"clip0_705_1930",children:(0,n.jsx)("rect",{width:"21",height:"20",fill:"white"})})})]})})}),Z?(0,n.jsxs)(s.Z.Body,{children:[(0,n.jsx)(i.Z,{now:I,style:{width:"308px",height:"28px",margin:"auto",backgroundColor:"#1F2123",borderRadius:"50px",border:"1px solid #3E3C3C",borderStyle:"double",color:"#EC995C"}}),(0,n.jsx)("p",{style:{fontSize:"16px",color:"#fff",marginTop:"32px"},children:"Moby is preparing your script."})]}):(0,n.jsx)(s.Z.Body,{children:(0,n.jsxs)("div",{className:"mx-auto",style:{margin:"0",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[(0,n.jsx)("div",{style:{marginBottom:"33px"},children:(0,n.jsxs)("p",{className:d().className,style:{fontSize:"16px",color:"#fff"},children:["Drag and Drop or ",(0,n.jsx)("span",{className:u().className,style:{fontSize:"16px"},children:"Choose a PDF"})," to Upload"]})}),(0,n.jsx)("input",{ref:M,onChange:O,className:"d-none",type:"file",hidden:!0}),(0,n.jsx)("button",{onClick:()=>{var e;null===(e=M.current)||void 0===e||e.click()},style:{padding:"0",fontSize:"16px"},children:N||(0,n.jsxs)("svg",{width:"60",height:"60",viewBox:"0 0 60 60",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("path",{d:"M23.75 55H7C5.89543 55 5 54.1046 5 53V7C5 5.89543 5.89543 5 7 5H25.472C25.9724 5 26.4546 5.18757 26.8235 5.52569L40.6014 18.1555C41.0147 18.5343 41.25 19.0692 41.25 19.6298V21.25",stroke:"white",strokeWidth:"2",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M26.25 6.25V16.75C26.25 17.8546 27.1454 18.75 28.25 18.75H40",stroke:"white",strokeWidth:"2",strokeLinejoin:"round"}),(0,n.jsx)("circle",{cx:"41.25",cy:"41.25",r:"13.75",stroke:"white",strokeWidth:"2",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M41.25 35V47.5",stroke:"white",strokeWidth:"2",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M35 41.25H47.5",stroke:"white",strokeWidth:"2",strokeLinejoin:"round"})]})})]})})]})})}var g=o(4205),f=o(7103),m=o(3506),j=o(4161),y=o(3419),w=o.n(y),k=e=>{let{listOfNames:t,chooseCharacter:o}=e;t.forEach(e=>{e.name&&(e.name=e.name.replace(/ *\([^)]*\) */g,""))});let s=[...new Set(t.map(e=>e.name))],[i,l]=(0,r.useState)(""),a=e=>{o(e.target.value),l(e.target.value)};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(m.Z.Select,{value:i,onChange:e=>a(e),style:{color:"white",backgroundColor:"#1F2123",width:"100%",textAlign:"center",padding:"10px",borderRadius:"5px"},children:s.map((e,t)=>{if(e)return(0,n.jsx)("option",{value:e,className:w().className,style:{color:"white"},children:e},t)})})})},b=e=>{let{scriptTitle:t,scriptDialogue:o,chooseCharacter:s,showScript:i}=e,[a,c]=(0,r.useState)(!1);(0,r.useEffect)(()=>{o&&o.length>0&&c(!0)},[a]);let h=()=>{c(!1),i(!0)};return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(j.Z,{show:a,size:"lg",onHide:h,backdrop:"static",keyboard:!1,centered:!0,children:[(0,n.jsx)(j.Z.Header,{closeButton:!0,style:{borderBottom:"none",backgroundColor:"#3E3E43"},children:(0,n.jsx)(l.Z,{variant:"none",size:"lg",onClick:h,children:(0,n.jsx)(f.Z,{style:{color:"#fff"}})})}),(0,n.jsx)(j.Z.Body,{style:{backgroundColor:"#3E3E43",display:"flex",justifyContent:"center",alignItems:"center",paddingBottom:"0"},children:(0,n.jsxs)(m.Z,{children:[(0,n.jsx)(m.Z.Group,{className:"mb-3",controlId:"exampleForm.ControlInput1",children:(0,n.jsx)(m.Z.Control,{size:"lg",type:"scriptTitle",value:t.substring(0,t.lastIndexOf(".")),autoFocus:!0,style:{textAlign:"center",color:"#fff",backgroundColor:"#1F2123",border:"none",fontSize:"24px"},readOnly:!0})}),(0,n.jsxs)(m.Z.Group,{className:" pt-5 pb-3",controlId:"exampleForm.ControlTextarea1",style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[(0,n.jsx)(m.Z.Label,{style:{display:"flex",justifyContent:"center",alignItems:"center",color:"white"},children:(0,n.jsx)("span",{className:d().className,style:{fontSize:"16px"},children:"Who are you reading as?"})}),(0,n.jsx)("div",{style:{border:"none",display:"flex",justifyContent:"center",width:"100%"},children:(0,n.jsx)(k,{listOfNames:o,chooseCharacter:s})})]})]})}),(0,n.jsx)(j.Z.Footer,{style:{borderTop:"none",backgroundColor:"#3E3E43",display:"flex",justifyContent:"center",alignItems:"center",paddingTop:"0"},children:(0,n.jsx)(l.Z,{size:"lg",onClick:()=>h(),style:{width:"87px",height:"50px",borderRadius:"5px",fontSize:"18px",backgroundColor:"#EC5500",border:"none"},children:(0,n.jsx)("span",{className:d().className,children:"Start"})})})]})})};let v=o(6042);var C=e=>{let{scriptToRead:t,chosenCharacter:o,clickedStart:s}=e,i=window.SpeechRecognition||window.webkitSpeechRecognition,l=new i;console.log("script",t),console.log("character that the user has identified",o);let a=t.filter(e=>"SCENE_ACTION"!==e.type),c=0,d=!1,h=!1;(0,r.useEffect)(()=>{s&&x()},[s]);let u=e=>{let t="dialogue".concat(c);console.log(t),e?(console.log("in user start turn"),d=!0,document.getElementById(t).style.backgroundColor="rgba(255,255,0,0.7)"):(console.log("in user end turn"),d=!1,document.getElementById(t).style.backgroundColor="transparent")},p=e=>{let t="dialogue".concat(c);console.log(t),e?(console.log("in moby start turn"),h=!0,document.getElementById(t).style.backgroundColor="rgba(214, 86, 0, 0.6)"):(console.log("in moby end turn"),h=!1,document.getElementById(t).style.backgroundColor="transparent")},x=()=>{if(c>=a.length){console.log("mobyTurn",h),console.log("userTurn",d),h?p(!1):d&&u(!1),console.log("DONE");let e=new i;e.start(),e.stop();return}let e=a[c],t=e.name.valueOf();if(t==o){let e=new i;console.log("enters user block"),u(!0),e.onresult=e=>{let t=e.results[0][0].transcript.toLowerCase().replace(/\s/g,"");console.log("transcribed: ",t),g(t)},e.continuous=!0,e.start(),console.log("listening...")}else{console.log("enters reader block");let t=e.audioBuffer&&e.audioBuffer.slice(0);f(t)}};t.length>0&&(l.onresult=e=>{let t=e.results[e.results.length-1][0].transcript.toLowerCase().replace(/\s/g,"");console.log("start command?: ",t),"start"===t&&x()},l.continuous=!0,l.start(),console.log("ready to begin"));let g=e=>{console.log("entered speech fn");let t=-1,o=v.ratio(e,a[c].line.replace(/ *\([^)]*\) */g,""));o>t&&(t=o,a[c].line),t>70&&(u(!1),c++),x()},f=async e=>{let t;console.log("entered audio fn"),p(!0);let o=new AudioContext;try{await e.byteLength>0?o.decodeAudioData(e.buffer,e=>{o.resume(),(t=o.createBufferSource()).connect(o.destination),t.buffer=e,t.start(0),t.addEventListener("ended",()=>{console.log("moby turn over"),p(!1),c++,x()})},e=>{console.log("Error parsing through arrayBuffer",e.message)}):console.error("did not find any arguments")}catch(e){console.log(e)}};return(0,n.jsx)(n.Fragment,{})},S=o(1630),N=o(7755),E=o(5630),T=e=>{let{type:t,name:o,text:r,keyProp:s}=e;return t&&"SCENE_ACTION"===t?(0,n.jsx)("div",{style:{padding:"10px 0"},children:(0,n.jsx)("div",{className:"text-left",children:(0,n.jsx)("span",{className:d().className,style:{fontSize:"16pt",color:"white"},children:r})})}):(0,n.jsxs)("div",{style:{margin:"1%",padding:"10px 0"},children:[(0,n.jsx)("div",{className:"text-center",children:(0,n.jsx)("span",{className:d().className,style:{fontSize:"16pt",color:"white"},children:o})}),(0,n.jsx)("div",{className:"text-left",style:{marginLeft:"20%",marginRight:"20%"},children:(0,n.jsx)("span",{id:"dialogue".concat(s),className:d().className,style:{color:"white",fontSize:"16pt"},children:r})})]})},L=o(4313),Z=o.n(L),B=e=>{let{script:t,clickStart:o}=e,[s,i]=(0,r.useState)(!0),a=-1;return(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{style:{filter:"".concat(s?"blur(10px)":"none"),background:"transparent",textAlign:"center"},children:[(0,n.jsx)(j.Z,{centered:!0,size:"lg",show:s,style:{backgroundColor:"transparent",border:"none"},children:(0,n.jsxs)(j.Z.Body,{style:{background:"transparent",border:"none",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:[(0,n.jsxs)("p",{className:Z().className,style:{fontSize:"24px",textAlign:"center",color:"#fff"},children:['Say "start" to begin reading or click the Start button. ',(0,n.jsx)("br",{})," Click the Restart Script button at any time to go from the top."]}),(0,n.jsx)(l.Z,{onClick:()=>i(!1),style:{padding:"15px",width:"94px",height:"50px",backgroundColor:"#D65600",color:"#fff",lineHeight:"100%",border:"none",marginTop:"32px"},children:"Got it"})]})}),(0,n.jsx)(l.Z,{onClick:()=>o(!0),className:d().className,style:{backgroundColor:"#D65600",width:"87px",height:"50px",color:"#fff",border:"none",fontSize:"16px",marginBottom:"48px"},children:"Start"}),(0,n.jsx)("div",{style:{padding:"0 10%",height:"80vh",overflowY:"scroll"},children:t.map((e,t)=>"SCENE_ACTION"===e.type?(0,n.jsx)(T,{type:e.type,name:"",text:e.text},t):(a++,(0,n.jsx)(T,{keyProp:a,type:e.type,name:e.name,text:e.line},t)))})]})})},I=o(6946),z=e=>{let{scriptTitle:t}=e,[o,s]=(0,r.useState)(!0),i=t.includes("Risk-Management")?"Risk-Management":"White-Room",a=o?"sidebar open":"sidebar",c=o?"sideBtn open":"sideBtn";return(0,n.jsx)("div",{style:{padding:"0"},className:a,children:(0,n.jsxs)(I.Z,{style:{top:"0",bottom:"0",left:"0",minHeight:"100vh",padding:"48px 0 0",zIndex:"100",display:"flex",flexDirection:"column",alignItems:"center"},onSelect:e=>alert("selected ".concat(e)),children:[(0,n.jsx)(l.Z,{variant:"",className:c,onClick:()=>s(!o),children:o?(0,n.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("rect",{x:"0.5",y:"0.5",width:"31",height:"31",rx:"5.5",fill:"#3E3E43"}),(0,n.jsx)("path",{d:"M24.332 9.3335L15.9987 16.0002L24.332 22.6668",stroke:"white",strokeWidth:"1.5",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M16 9.3335L7.66667 16.0002L16 22.6668",stroke:"white",strokeWidth:"1.5",strokeLinejoin:"round"})]}):(0,n.jsxs)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("rect",{x:"31.5",y:"31.5",width:"31",height:"31",rx:"5.5",transform:"rotate(-180 31.5 31.5)",fill:"#3E3E43"}),(0,n.jsx)("path",{d:"M7.66797 22.6665L16.0013 15.9998L7.66797 9.33317",stroke:"white",strokeWidth:"1.5",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M16 22.6665L24.3333 15.9998L16 9.33317",stroke:"white",strokeWidth:"1.5",strokeLinejoin:"round"})]})}),(0,n.jsxs)(l.Z,{variant:"none",size:"lg",style:{border:"2px solid #D65600",borderRadius:"5px",width:"171px",height:"50px",fontSize:"18px",color:"#fff",backgroundColor:"#3E3E43"},children:["+ ",(0,n.jsx)("span",{className:u().className,children:"Upload Script"})]}),(0,n.jsxs)(I.Z.Item,{style:{backgroundColor:"#3E3E43",color:"#fff",display:"flex",flexDirection:"row",justifyContent:"space-evenly",alignItems:"center",padding:"13px 0 12px 5px",borderRadius:"0px",marginTop:"36px",fontSize:"16px",textAlign:"center",width:"100%"},children:[(0,n.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("path",{d:"M5.33203 18.3337H14.6654C15.7699 18.3337 16.6654 17.4382 16.6654 16.3337V7.58686C16.6654 7.00301 16.4102 6.44831 15.9669 6.06835L11.3938 2.14848C11.0313 1.83778 10.5696 1.66699 10.0922 1.66699H5.33203C4.22746 1.66699 3.33203 2.56242 3.33203 3.66699V16.3337C3.33203 17.4382 4.22746 18.3337 5.33203 18.3337Z",stroke:"white",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M10.832 2.08398V4.66732C10.832 5.77189 11.7275 6.66732 12.832 6.66732H16.2487",stroke:"white",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M5.83203 10H12.4987",stroke:"white",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M5.83203 12.5H9.58203",stroke:"white",strokeLinejoin:"round"}),(0,n.jsx)("path",{d:"M5.83203 15H11.6654",stroke:"white",strokeLinejoin:"round"})]}),i]})]})})},D=e=>{let{scriptTitle:t,script:o,clickStart:s}=e,[i,l]=(0,r.useState)(!0);return(0,n.jsx)("div",{style:{height:"100vh",width:"100vw"},children:(0,n.jsx)(E.Z,{style:{maxWidth:"100vw",padding:"0"},children:(0,n.jsxs)(N.Z,{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[(0,n.jsx)(S.Z,{sm:2,style:{borderRight:"0.5px solid #3E3E43",width:"224px",paddingRight:"5px"},children:(0,n.jsx)(z,{scriptTitle:t})}),(0,n.jsx)(S.Z,{sm:9,style:{height:"100vh",width:"80%"},children:(0,n.jsx)(B,{script:o,clickStart:s})})]})})})};function F(){let[e,t]=(0,r.useState)([]),[o,s]=(0,r.useState)(!1),[i,l]=(0,r.useState)(!1),[a,c]=(0,r.useState)(!1),[d,h]=(0,r.useState)(!1),[u,p]=(0,r.useState)(!1),[f,m]=(0,r.useState)(!1),[j,y]=(0,r.useState)(""),[w,k]=(0,r.useState)(void 0),[v,S]=(0,r.useState)(!1),[N,E]=(0,r.useState)(!1);return(0,n.jsx)("div",{style:{margin:"0",width:"100%",height:"100vh",display:"flex",alignItems:"center",flexDirection:"column",backgroundColor:"#1F2123"},children:e.length>0?v?(0,n.jsxs)("div",{style:{height:"100vh"},children:[(0,n.jsx)(D,{scriptTitle:j,script:e,clickStart:E}),(0,n.jsx)(C,{scriptToRead:e,chosenCharacter:w,clickedStart:N})]}):(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(b,{scriptTitle:j,scriptDialogue:e,chooseCharacter:k,showScript:S})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.Z,{}),(0,n.jsx)(x,{setTheScript:t,setScriptTitle:y,isParseLoading:o,setParseLoad:s,isParseError:i,setParseError:l,isGPTLoading:a,setGPTLoad:c,isGPTError:d,setGPTError:h,isTTSLoading:u,setTTSLoad:p,isTTSError:f,setTTSError:m})]})})}}},function(e){e.O(0,[603,972,253,698,744],function(){return e(e.s=612)}),_N_E=e.O()}]);